#include <stdio.h>
#include <stdlib.h>
#include <locale.h>
#define a 5

void usina_inicio()
{
    system("cls");
    printf("\n=======================================\n");
    printf("\n\tUSINA DE RECICLAGEM DE LIXO\n");
    printf("\n=======================================\n");
}

int main()
{
    setlocale(LC_ALL,"");

    //variáveis referentes a coleta e processamento
    float peso_mat_coletado[a],total_mat_coletado=0,valor_mat_coletado,peso_mat_triado[a],total_mat_triado=0,cap_triagem=100,cap_prensagem=100;

    //variáveis referentes ao estoque
    float peso_mat_estoque[a],valor_mat_estoque[a],mat_saida_estoque,cap_estoque=50,cap_coleta=100,est_coleta=0;

    //variáveis referentes a reciclagem
    float peso_mat_reciclado[a],total_mat_reciclado=0,valor_mat_reciclado[a];

    //variáveis referentes ao armazém
    float peso_mat_armazem[a],valor_mat_armazem[a],cap_armazem=50,total_mat_armazem=0;

    //variáveis referentes ao descarte
    float peso_mat_descarte[a],valor_mat_descarte[a],cap_descarte=50,total_mat_descartado=0;

    //variáveis referentes ao lucro e despesas
    float peso_mat_venda[a],valor_mat_venda[a],funcionarios,transporte,manutencao,lucro_reciclagem;

 int i, modalidade=0;
 char escolha;

 //estas variáveis do char serão utilizadas numa futura versão do programa em que os dados estarão salvos em arquivos
 //os arquivos incluirão mês e data de cada reciclagem, média de reciclagem por dia, semana, mês e ano
 char mes_maior_rendimento,dia_maior_rendimento,local_processamento,local_armazem,local_estoque,local_descarte,local_retirada;

    system("color 20");

    while(modalidade<8)
    {
        usina_inicio();
        printf("Bem-vindo!!\n");
        printf("Informe o procedimento a ser executado:\n");
        printf("1 - Coleta\n");
        printf("2 - Triagem\n");
        printf("3 - Prensagem\n");
        printf("4 - Estoque\n");
        printf("5 - Descarte\n");
        printf("6 - Armazém\n");
        printf("7 - Venda\n");
        printf("0 - Voltar ao menu\n\n");
        printf("Opção >> ");
        scanf("%d", &modalidade);

        if(modalidade>7||modalidade<0)
        {
            printf("\n\n OPÇÃO INVÁLIDA");
            system("pause");
            system("cls");
        }


        switch(modalidade)
        {
            case 1:
            {
                system("cls");
                printf("\n=======================================\n");
                printf("\n\tCADASTRO DA COLETA\n");
                printf("\n=======================================\n");

                for(i=0;i<a;i++)
                {
                    //pergunta a quantidade de material em peso coletado de cada área
                    printf("Informe o peso do material coletado de cada área: ");
                    scanf("%f", &peso_mat_coletado[i]);

                    total_mat_coletado=total_mat_coletado+peso_mat_coletado[i];
                    cap_triagem=cap_triagem-total_mat_coletado;
                }

                system("cls");
                printf("\n=======================================\n");
                printf("\nCOLETA DE HOJE\n");
                printf("\n=======================================\n");
                printf("Área   Quantidade");

                for(i=0;i<a;i++)
                {
                    printf("\n%d -    %.2f t\n",i,peso_mat_coletado[i]);
                }

                printf("\nTotal de Material Coletado: %.2f t\n",total_mat_coletado);

                printf("Para retornar ao menu, digite 0 >> \n");
                scanf("%d",&modalidade);
                break;
            }

            case 2:
            {
                system("cls");
                printf("\n=======================================\n");
                printf("\n\tTRIAGEM\n");
                printf("\n=======================================\n");

                if((total_mat_coletado==0)&&(total_mat_triado==0))
                {
                    //Informa que não há material disponível para ser reciclado
                    printf("Favor informar a quantidade coletada primeiro ou retirar do estoque\n");
                    printf("Para retornar para o menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                }

                if(cap_triagem==0)
                {
                    //Informa que não é possível realizar a triagem porque não tem capacidade suficiente
                    //Essa opção só aparece quando foi coletado lixo acima da capacidade de reciclagem
                    printf("Não há capacidade suficiente para realizar a triagem.\n");
                    printf("O material coletado é: %.2f\n",total_mat_coletado);
                    printf("O material terá que ser destinado ao estoque de materiais coletados.\n");
                    printf("Estoque disponível para armazenamento: %.2f\n",cap_coleta);

                    printf("Deseja destinar quanto para o estoque? >> ");
                    scanf("%f", &est_coleta);

                    cap_coleta=cap_coleta-est_coleta;
                    total_mat_coletado=total_mat_coletado-est_coleta;
                    cap_triagem=cap_triagem+total_mat_coletado;

                    system("pause");
                    printf("O material coletado informado foi movido para o estoque\n");
                }

                if((total_mat_coletado>0)&&(total_mat_coletado<=cap_triagem))
                {
                    printf("O total de material coletado é: %.2f t",total_mat_coletado);
                    printf("\nO material poderá ser triado.\n");
                    printf("Capacidade de triagem: %.2f t",cap_triagem);

                    for(i=0;i<a;i++)
                    {
                        system("cls");
                        printf("Ordem dos Materiais: \n");
                        printf("0 - Papel\n");
                        printf("1 - Plástico\n");
                        printf("2 - Metal\n");
                        printf("3 - Vidro\n");
                        printf("4 - Orgânico\n");

                        //deve informar o quanto foi triado do material coletado ou retirado do estoque
                        printf("Quanto foi triado do material[%d]? ",i);
                        scanf("%f",&peso_mat_triado[i]);

                        //deve informar o quanto foi descartado do material coletado ou retirado do estoque
                        printf("Quanto foi descartado do material[%d]? ",i);
                        scanf("%f",&peso_mat_descarte[i]);

                        total_mat_triado=total_mat_triado+peso_mat_triado[i];
                        total_mat_descartado=total_mat_descartado+peso_mat_descarte[i];
                        total_mat_coletado=total_mat_coletado-(peso_mat_triado[i]+peso_mat_descarte[i]);

                        cap_triagem=cap_triagem+(peso_mat_triado[i]+peso_mat_descarte[i]);
                        cap_descarte=cap_descarte-peso_mat_descarte[i];
                    }

                    printf("Os materiais estão prontos para prensagem ou separados para descarte\n");
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                }
                break;
        }

            case 3:
            {
                system("cls");
                printf("\n=======================================\n");
                printf("\n\tPRENSAGEM\n");
                printf("\n=======================================\n");

                if(total_mat_triado==0)
                {
                    printf("É preciso ter material triado para realizar a prensagem\n");
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                }

                if(total_mat_triado>0)
                {
                    printf("O material triado será encaminhado para a prensagem.\n");
                    system("pause");

                    for(i=0;i<a;i++)
                        {
                            total_mat_reciclado=total_mat_reciclado+total_mat_triado;
                            peso_mat_reciclado[i]=peso_mat_triado[i];
                            peso_mat_armazem[i]=peso_mat_reciclado[i];
                            total_mat_armazem=total_mat_reciclado;
                            cap_armazem=cap_armazem-total_mat_armazem;
                        }

                    printf("A reciclagem foi concluída.\n");
                    system("pause");

                    printf("\n=======================================\n");
                    printf("\n\nMATERIAIS RECICLADOS\n\n");
                    printf("\n=======================================\n");

                    printf("Reciclado    Descartado");

                    for(i=0;i<a;i++)
                        {
                            printf("\n%.2f t -    %.2f t\n",peso_mat_reciclado[i],peso_mat_descarte[i]);
                        }

                    printf("\nTotal de Material Reciclado: %.2f t\n",total_mat_reciclado);
                    printf("Os reciclados estão prontos para venda\n");
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);

                }
                break;
            }

            case 4:
            {
                system("cls");
                printf("\n=======================================\n");
                printf("\n\tDADOS DO ESTOQUE\n");
                printf("\n=======================================\n");

                printf("O estoque da coleta é de: %.2f\n",est_coleta);
                printf("O estoque de material reciclado é %.2f t\n",total_mat_reciclado);
                printf("A capacidade de estoque de reciclados está em %.2f t\n",cap_estoque);

            if((est_coleta>0)||(cap_estoque<1000))
            {
            printf("Informe c para Estoque da Coleta ou r para Estoque de Reciclados: ");
            scanf("%c",&escolha);

            if((escolha=='c')&&(est_coleta>0))
            {
                printf("Há material disponível para triagem no estoque\n");
                printf("Informe quanto deseja mover para a triagem: \n");
                scanf("%f",&mat_saida_estoque);
                est_coleta=est_coleta-mat_saida_estoque;
            }

            if((escolha=='c')&&(est_coleta==0))
            {
                printf("Mover coletados para o estoque?[s/n]? \n");
                scanf("%c",&escolha);

                if(escolha=='s')
                {
                    printf("Tem %.2f t de material coletado\n",total_mat_coletado);
                    printf("Quanto desejar mover para o estoque? \n");
                    scanf("%f",&est_coleta);

                    total_mat_coletado=total_mat_coletado-est_coleta;
                }

                if(escolha=='n')
                {
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                }
            }

            if((escolha=='r')&&(total_mat_reciclado>0))
                {
                    printf("Há material disponível para encaminhar ao armazém\n");
                    for(i=0;i<a;i++)
                        {
                            printf("Ordem dos Materiais: \n");
                            printf("0 - Papel\n");
                            printf("1 - Plástico\n");
                            printf("2 - Metal\n");
                            printf("3 - Vidro\n");
                            printf("4 - Orgânico\n");

                            //deve informar o quanto irá mover do estoque de reciclados para o armazém
                            printf("Quanto deseja mover para o armazém?\n");
                            scanf("%f",&peso_mat_estoque[i]);

                            peso_mat_armazem[i]=peso_mat_estoque[i];
                            peso_mat_estoque[i]=peso_mat_estoque[i]-peso_mat_armazem[i];
                            cap_estoque=cap_estoque+peso_mat_armazem[i];
                        }

                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);

                }

           if((escolha!='c')&&(escolha!='r'))
            {
                printf("Para retornar ao menu, digite 0 >> ");
                scanf("%d",&modalidade);
            }
        }
           printf("Para retornar ao menu, digite 0 >> ");
            scanf("%d",&modalidade);
        }

            case 5:
            {
                system("cls");
                printf("\n=======================================\n");
                printf("\n\tDADOS DO DESCARTE\n");
                printf("\n=======================================\n");

                printf("O descarte está com %.2f t de capacidade",cap_descarte);
                printf("O total de material a ser descartado é: %.2f t", total_mat_descartado);

                while(total_mat_descartado>0)
                {
                    printf("Deseja encaminhar o material ao descarte?[s/n] >> ");
                    scanf("%c",&escolha);

                    if(escolha!=('s'||'n'))
                    {
                        printf("Opção inválida...\n");
                        printf("Escolha uma das opções.");
                    }

                    if(escolha=='s')
                    {
                        printf("O material será descartado no aterro\n");
                        system("pause");
                        cap_descarte=cap_descarte+total_mat_descartado;
                        total_mat_descartado=total_mat_descartado-total_mat_descartado;

                        for(i=0;i<a;i++)
                        {
                            peso_mat_descarte[i]=peso_mat_descarte[i]-peso_mat_descarte[i];
                        }

                        system("pause");
                        modalidade==0;
                    }

                    if(escolha=='n')
                    {
                        printf("É recomendado descartar o material antes que acumule.");
                    }
                }
                break;
            }

            case 6:
            {
                printf("\n=======================================\n");
                printf("\n\tCADASTRO DO ARMAZÉM\n");
                printf("\n=======================================\n");

                printf("O armazém está com %.2f t de capacidade",cap_armazem);
                printf("O total de material no armazém é de %.2f t",total_mat_reciclado);

                if(total_mat_reciclado>0)
                {
                    printf("Há %.2f t de material reciclado pronto para ser vendido",total_mat_reciclado);
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                }

            printf("Deseja retornar ao menu? Digite 0 ");
            scanf("%d",&modalidade);
            break;
            }

            case 7:
            {
                system("cls");
                printf("\n=======================================\n");
                printf("\n\tCADASTRO DA VENDA\n");
                printf("\n=======================================\n");

                if(total_mat_reciclado==0)
                {
                    printf("É preciso ter reciclados para realizar a venda\n");
                    printf("Verifique se há materiais para coleta, no estoque ou no armazém\n");
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                }

                if(total_mat_reciclado>0)
                {
                    printf("Há reciclados para serem avaliados.\n");
                    printf("Informe os valores de cada reciclado por kilo: \n");

                    for(i=0;i<a;i++)
                    {
                        printf("Ordem dos Materiais: \n");
                        printf("0 - Papel\n");
                        printf("1 - Plástico\n");
                        printf("2 - Metal\n");
                        printf("3 - Vidro\n");
                        printf("4 - Orgânico\n");

                        //deve informar o quanto cada material irá valer
                        printf("Informe os valores de cada reciclado por kilo: ");
                        scanf("%f",&valor_mat_venda[i]);
                    }

                    for(i=0;i<a;i++)
                    {
                        valor_mat_reciclado[i]=valor_mat_venda[i]*peso_mat_reciclado[i];
                        valor_mat_estoque[i]=valor_mat_venda[i]*peso_mat_estoque[i];
                        valor_mat_armazem[i]=valor_mat_venda[i]*peso_mat_armazem[i];
                        valor_mat_descarte[i]=valor_mat_venda[i]*peso_mat_descarte[i];
                    }

                printf("\n=======================================\n");
                printf("\n\nVALORES DOS MATERIAIS\n\n");
                printf("\n=======================================\n");

                printf("Reciclado    Estoque    Armazém     Descarte    Valor");

                    for(i=0;i<a;i++)
                        {
                            printf("\nR$ %.2f  -  R$ %.2f   -   R$%.2f  -   R$.2f   -   R$.2f\n",valor_mat_reciclado[i],valor_mat_estoque[i],valor_mat_armazem[i],valor_mat_descarte[i],valor_mat_venda[i]);
                        }

                printf("Deseja vender material?[s/n] >> ");
                scanf("%c",&escolha);
                if(escolha=='s')
                {
                    system("cls");
                    printf("\n=======================================\n");
                    printf("\n\nVALORES DOS MATERIAIS\n\n");
                    printf("\n=======================================\n");

                    printf("Peso    Valor Estimado    Valor por Kg");

                    for(i=0;i<a;i++)
                        {
                            printf("\n%.2f t  -  R$ %.2f   -   R$%.2f\n",peso_mat_reciclado[i],valor_mat_reciclado[i],valor_mat_venda[i]);
                        }

                    printf("Informe a quantidade de reciclados por peso a serem vendidos: ");
                    for(i=0;i<a;i++)
                        {
                            printf("Ordem dos Materiais: \n");
                            printf("0 - Papel\n");
                            printf("1 - Plástico\n");
                            printf("2 - Metal\n");
                            printf("3 - Vidro\n");
                            printf("4 - Orgânico\n");

                            //deve informar a quantidade em peso de cada material
                            scanf("%f",&peso_mat_venda[i]);

                            peso_mat_reciclado[i]=peso_mat_reciclado[i]-peso_mat_venda[i];
                            cap_armazem=cap_armazem+peso_mat_reciclado[i];
                        }
                    printf("Materiais reciclados vendidos.\n");
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                    }

                    if(escolha=='n')
                    {
                    printf("Para retornar ao menu, digite 0 >> ");
                    scanf("%d",&modalidade);
                    }
                }
                break;
            }
        }

    }

    return 0;
}
